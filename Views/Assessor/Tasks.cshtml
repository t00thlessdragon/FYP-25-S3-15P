@model FYP_25_S3_15P.ViewModels.AssessorTaskDeliverablesVm
@{ Layout = "~/Views/Shared/_AssessorLayout.cshtml"; }

<section class="container-wide card-xl">
  <div class="card rounded-4 p-4 p-lg-5 shadow-lg">

    <!-- Heading + Close -->
    <div class="d-flex justify-content-between align-items-start mb-3">
      <h2 class="mb-0">Task Deliverables</h2>
      <a asp-action="Projects" class="btn-close" aria-label="Close"></a>
    </div>

    <!-- Header -->
    <div class="fs-5 mb-4">
      <p class="mb-1"><strong>Project ID:</strong> @Model.ProjectId</p>
      <p class="mb-1"><strong>Project Title:</strong> @Model.Title</p>
      <p class="mb-1"><strong>Project Group:</strong> @Model.GroupId</p>
      <p class="mb-1"><strong>Supervisor Assigned:</strong> @Model.Supervisor</p>
      <p class="mb-3"><strong>Assessor Assigned:</strong> @Model.Assessor</p>

      <p class="mb-1"><strong>Project Member:</strong></p>
      <div class="ps-4">
        @foreach (var m in Model.Members) { <div>@m</div> }
      </div>
    </div>

    <!-- Table -->
    <div class="table-responsive">
      <table class="table align-middle">
        <thead class="table-dark">
          <tr>
            <th style="width:120px;">Task ID</th>
            <th>Task Title</th>
            <th style="width:180px;">Submission Date</th>
            <th style="width:160px;">Due Date</th>
            <th style="width:140px;">Status</th>
            <th class="text-end" style="width:220px;">Action</th>
          </tr>
        </thead>
        <tbody>
        @if (Model.Tasks == null || Model.Tasks.Count == 0)
        {
            <tr>
              <td colspan="6">
                <div class="text-center text-muted py-5">No task deliverables found.</div>
              </td>
            </tr>
        }
        else
        {
            foreach (var t in Model.Tasks)
            {
                <tr>
                  <td>@t.TaskId</td>
                  <td class="fw-semibold">@t.Title</td>
                  <td>@t.SubmittedOn.ToString("dd MMM yyyy")</td>
                  <td>@t.DueDate.ToString("dd MMM yyyy")</td>
                  <td>
                    @if (t.Status.Equals("Submitted", StringComparison.OrdinalIgnoreCase))
                    { <span class="badge rounded-pill text-bg-success">Submitted</span> }
                    else if (t.Status.Equals("Pending", StringComparison.OrdinalIgnoreCase))
                    { <span class="badge rounded-pill text-bg-secondary">Pending</span> }
                    else
                    { <span class="badge rounded-pill text-bg-light text-dark">@t.Status</span> }
                  </td>
                  <td class="text-end">
                    <a asp-action="TaskInfo"
                asp-route-projectId="@Model.ProjectId"
                asp-route-taskId="@t.TaskId"
                asp-route-from="project" 
                class="btn btn-dark btn-sm px-4">
                View
                    </a>
                    <a class="btn btn-dark btn-sm px-4">Download</a>
                  </td>
                </tr>
            }
        }
        </tbody>
      </table>
    </div>

  </div>
</section>
